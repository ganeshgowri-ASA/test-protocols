{
  "metadata": {
    "protocol_id": "PVTP-013",
    "protocol_name": "Temperature Coefficient Measurement",
    "version": "1.0.0",
    "effective_date": "2025-01-01",
    "category": "Electrical Performance",
    "subcategory": "Temperature Dependence Testing",
    "standard_references": [
      "IEC 60891:2021",
      "IEC 61853-1:2011",
      "IEC 60904-1:2020"
    ],
    "author": "PV Testing Lab",
    "approver": null,
    "approval_date": null,
    "revision_history": [
      {
        "version": "1.0.0",
        "date": "2025-01-01",
        "changes": "Initial version",
        "author": "PV Testing Lab"
      }
    ]
  },
  "inputs": {
    "required": {
      "sample_id": {
        "type": "string",
        "label": "Sample ID",
        "description": "Unique identifier for the PV module",
        "validation": {
          "pattern": "^[A-Z0-9-]+$",
          "min_length": 5,
          "max_length": 50
        }
      },
      "manufacturer": {
        "type": "string",
        "label": "Manufacturer"
      },
      "model": {
        "type": "string",
        "label": "Model Number"
      },
      "serial_number": {
        "type": "string",
        "label": "Serial Number"
      },
      "technology": {
        "type": "select",
        "label": "Cell Technology",
        "options": [
          "mono-Si",
          "multi-Si",
          "PERC",
          "HJT",
          "TOPCon",
          "CdTe",
          "CIGS",
          "a-Si",
          "Perovskite",
          "Other"
        ]
      },
      "test_date": {
        "type": "date",
        "label": "Test Date",
        "default": "today"
      },
      "operator": {
        "type": "string",
        "label": "Test Operator"
      },
      "test_method": {
        "type": "select",
        "label": "Test Method",
        "options": [
          "Indoor (Climate Chamber)",
          "Outdoor (Natural Heating/Cooling)",
          "Thermal Cycling Chamber"
        ],
        "default": "Indoor (Climate Chamber)"
      }
    },
    "optional": {
      "project_id": {
        "type": "string",
        "label": "Project ID"
      },
      "customer": {
        "type": "string",
        "label": "Customer Name"
      },
      "module_area": {
        "type": "number",
        "label": "Module Area (m²)",
        "unit": "m²"
      },
      "datasheet_coefficients": {
        "type": "object",
        "label": "Datasheet Temperature Coefficients",
        "description": "For comparison with measured values",
        "fields": {
          "alpha_isc": {
            "type": "number",
            "label": "α (Isc) (%/°C)",
            "unit": "%/°C"
          },
          "beta_voc": {
            "type": "number",
            "label": "β (Voc) (%/°C)",
            "unit": "%/°C"
          },
          "gamma_pmax": {
            "type": "number",
            "label": "γ (Pmax) (%/°C)",
            "unit": "%/°C"
          }
        }
      },
      "notes": {
        "type": "text",
        "label": "Test Notes"
      }
    }
  },
  "measurements": {
    "temperature_test_points": {
      "label": "Temperature Test Points",
      "description": "Standard temperature test sequence",
      "configuration": {
        "temperature_range": {
          "min": 15,
          "max": 75,
          "unit": "°C",
          "standard_points": [15, 25, 35, 45, 55, 65, 75]
        },
        "irradiance_control": {
          "target": 1000,
          "tolerance": 50,
          "unit": "W/m²",
          "stability_required": true
        },
        "stabilization_time": {
          "value": 15,
          "unit": "minutes",
          "description": "Wait time at each temperature before measurement"
        }
      }
    },
    "measurement_sequence": {
      "label": "Temperature Sweep Measurements",
      "type": "array",
      "description": "I-V measurements at each temperature point",
      "automated": true,
      "sequence": [
        {
          "measurement_id": "T1",
          "target_temperature": 15,
          "fields": {
            "module_temperature_measured": {
              "type": "number",
              "label": "Module Temperature (°C)",
              "unit": "°C",
              "tolerance": 1.0,
              "uncertainty": "±0.3",
              "required": true,
              "measurement_points": 4,
              "locations": ["center", "corner1", "corner2", "corner3"]
            },
            "irradiance_measured": {
              "type": "number",
              "label": "Irradiance (W/m²)",
              "unit": "W/m²",
              "tolerance": 50,
              "uncertainty": "±2%",
              "required": true
            },
            "ambient_temperature": {
              "type": "number",
              "label": "Ambient Temperature (°C)",
              "unit": "°C",
              "uncertainty": "±0.5"
            },
            "voc": {
              "type": "number",
              "label": "Open Circuit Voltage (V)",
              "unit": "V",
              "uncertainty": "±0.5%",
              "required": true
            },
            "isc": {
              "type": "number",
              "label": "Short Circuit Current (A)",
              "unit": "A",
              "uncertainty": "±1%",
              "required": true
            },
            "pmax": {
              "type": "number",
              "label": "Maximum Power (W)",
              "unit": "W",
              "uncertainty": "±3%",
              "required": true
            },
            "vmpp": {
              "type": "number",
              "label": "Voltage at MPP (V)",
              "unit": "V",
              "uncertainty": "±0.5%",
              "required": true
            },
            "impp": {
              "type": "number",
              "label": "Current at MPP (A)",
              "unit": "A",
              "uncertainty": "±1%",
              "required": true
            },
            "fill_factor": {
              "type": "calculated",
              "label": "Fill Factor",
              "formula": "pmax / (voc * isc)"
            },
            "efficiency": {
              "type": "calculated",
              "label": "Efficiency (%)",
              "unit": "%",
              "requires": "module_area"
            },
            "series_resistance": {
              "type": "calculated",
              "label": "Series Resistance (Ω)",
              "unit": "Ω",
              "optional": true
            },
            "shunt_resistance": {
              "type": "calculated",
              "label": "Shunt Resistance (Ω)",
              "unit": "Ω",
              "optional": true
            },
            "iv_curve_data": {
              "type": "array",
              "label": "Full I-V Curve Data",
              "optional": true,
              "structure": {
                "voltage": {"type": "number", "unit": "V"},
                "current": {"type": "number", "unit": "A"}
              }
            },
            "stabilization_verified": {
              "type": "boolean",
              "label": "Temperature Stabilized",
              "required": true
            }
          }
        }
      ]
    },
    "temperature_uniformity": {
      "label": "Module Temperature Uniformity",
      "description": "Assess temperature distribution across module",
      "fields": {
        "temperature_sensors": {
          "type": "array",
          "label": "Temperature Sensor Readings",
          "min_sensors": 4,
          "structure": {
            "sensor_id": {"type": "string"},
            "location": {"type": "string"},
            "temperature": {"type": "number", "unit": "°C"}
          }
        },
        "max_temperature_difference": {
          "type": "calculated",
          "label": "Max Temperature Difference (°C)",
          "unit": "°C",
          "threshold": 2.0,
          "severity": "warning"
        }
      }
    }
  },
  "analysis": {
    "coefficient_calculation": {
      "label": "Temperature Coefficient Calculation",
      "description": "Calculate temperature coefficients using linear regression",
      "reference_temperature": 25.0,
      "reference_conditions": "STC (1000 W/m², 25°C, AM1.5G)",
      "methods": {
        "alpha_isc": {
          "label": "α (Isc) - Temperature Coefficient of Isc",
          "unit": "A/°C or %/°C",
          "calculation": "linear_regression",
          "x_variable": "module_temperature",
          "y_variable": "isc_normalized",
          "normalization": "to_1000_W_per_m2",
          "output_formats": {
            "absolute": "A/°C",
            "relative": "%/°C",
            "relative_to_stc": "%/°C from Isc@25°C"
          },
          "quality_metrics": {
            "r_squared": {"threshold": 0.98},
            "standard_error": {"report": true}
          }
        },
        "beta_voc": {
          "label": "β (Voc) - Temperature Coefficient of Voc",
          "unit": "V/°C or %/°C",
          "calculation": "linear_regression",
          "x_variable": "module_temperature",
          "y_variable": "voc_normalized",
          "normalization": "to_1000_W_per_m2",
          "output_formats": {
            "absolute": "V/°C",
            "relative": "%/°C",
            "relative_to_stc": "%/°C from Voc@25°C"
          },
          "quality_metrics": {
            "r_squared": {"threshold": 0.98},
            "standard_error": {"report": true}
          }
        },
        "gamma_pmax": {
          "label": "γ (Pmax) - Temperature Coefficient of Pmax",
          "unit": "W/°C or %/°C",
          "calculation": "linear_regression",
          "x_variable": "module_temperature",
          "y_variable": "pmax_normalized",
          "normalization": "to_1000_W_per_m2",
          "output_formats": {
            "absolute": "W/°C",
            "relative": "%/°C",
            "relative_to_stc": "%/°C from Pmax@25°C"
          },
          "quality_metrics": {
            "r_squared": {"threshold": 0.98},
            "standard_error": {"report": true}
          }
        },
        "additional_coefficients": {
          "delta_vmpp": {
            "label": "Temperature Coefficient of Vmpp",
            "unit": "V/°C or %/°C",
            "calculation": "linear_regression"
          },
          "delta_impp": {
            "label": "Temperature Coefficient of Impp",
            "unit": "A/°C or %/°C",
            "calculation": "linear_regression"
          },
          "delta_ff": {
            "label": "Temperature Coefficient of FF",
            "unit": "%/°C (absolute)",
            "calculation": "linear_regression"
          },
          "delta_efficiency": {
            "label": "Temperature Coefficient of Efficiency",
            "unit": "%/°C (absolute)",
            "calculation": "linear_regression"
          }
        }
      },
      "uncertainty_analysis": {
        "propagation_method": "GUM",
        "confidence_level": 0.95,
        "sources": [
          "temperature_measurement",
          "irradiance_measurement",
          "electrical_measurement",
          "regression_uncertainty"
        ]
      }
    },
    "irradiance_correction": {
      "label": "Irradiance Normalization",
      "description": "Correct all measurements to 1000 W/m²",
      "method": "linear_scaling",
      "validation": "check_irradiance_stability"
    },
    "comparison_to_datasheet": {
      "label": "Comparison to Datasheet Values",
      "description": "Compare measured coefficients to manufacturer specifications",
      "metrics": [
        {
          "parameter": "alpha_isc",
          "comparison": "percentage_difference",
          "tolerance": 20
        },
        {
          "parameter": "beta_voc",
          "comparison": "percentage_difference",
          "tolerance": 20
        },
        {
          "parameter": "gamma_pmax",
          "comparison": "percentage_difference",
          "tolerance": 20
        }
      ]
    },
    "temperature_dependent_behavior": {
      "label": "Temperature-Dependent Behavior Analysis",
      "analyses": {
        "fill_factor_variation": {
          "description": "Analyze FF change with temperature",
          "expected_behavior": "FF typically decreases with temperature"
        },
        "series_resistance_temperature": {
          "description": "Track Rs variation with temperature",
          "expected_behavior": "Rs may decrease slightly with temperature"
        },
        "shunt_resistance_temperature": {
          "description": "Track Rsh variation with temperature",
          "expected_behavior": "Rsh typically decreases with temperature"
        },
        "bandgap_estimation": {
          "description": "Estimate bandgap from Voc temperature dependence",
          "method": "Eg = q * (Voc + (dVoc/dT) * T)",
          "unit": "eV"
        }
      }
    },
    "hysteresis_check": {
      "label": "Temperature Hysteresis Analysis",
      "description": "Check for hysteresis in heating vs cooling cycles",
      "applicable_if": "bidirectional_sweep",
      "severity": "warning_if_significant"
    }
  },
  "charts": {
    "isc_vs_temperature": {
      "type": "scatter_with_fit",
      "title": "Isc vs. Temperature",
      "x_axis": "Module Temperature (°C)",
      "y_axis": "Isc (A, normalized to 1000 W/m²)",
      "fit_type": "linear",
      "show_equation": true,
      "show_r_squared": true,
      "show_confidence_bands": true,
      "annotations": ["α coefficient", "STC point"]
    },
    "voc_vs_temperature": {
      "type": "scatter_with_fit",
      "title": "Voc vs. Temperature",
      "x_axis": "Module Temperature (°C)",
      "y_axis": "Voc (V)",
      "fit_type": "linear",
      "show_equation": true,
      "show_r_squared": true,
      "show_confidence_bands": true,
      "annotations": ["β coefficient", "STC point"]
    },
    "pmax_vs_temperature": {
      "type": "scatter_with_fit",
      "title": "Pmax vs. Temperature",
      "x_axis": "Module Temperature (°C)",
      "y_axis": "Pmax (W, normalized to 1000 W/m²)",
      "fit_type": "linear",
      "show_equation": true,
      "show_r_squared": true,
      "show_confidence_bands": true,
      "annotations": ["γ coefficient", "STC point"]
    },
    "ff_vs_temperature": {
      "type": "scatter_with_fit",
      "title": "Fill Factor vs. Temperature",
      "x_axis": "Module Temperature (°C)",
      "y_axis": "Fill Factor",
      "fit_type": "linear",
      "show_trend": true
    },
    "efficiency_vs_temperature": {
      "type": "scatter_with_fit",
      "title": "Efficiency vs. Temperature",
      "x_axis": "Module Temperature (°C)",
      "y_axis": "Efficiency (%)",
      "fit_type": "linear",
      "show_trend": true
    },
    "residuals_plot": {
      "type": "multi_subplot",
      "title": "Regression Residuals",
      "subplots": [
        {"parameter": "Isc", "x_axis": "Temperature", "y_axis": "Residual"},
        {"parameter": "Voc", "x_axis": "Temperature", "y_axis": "Residual"},
        {"parameter": "Pmax", "x_axis": "Temperature", "y_axis": "Residual"}
      ]
    },
    "coefficients_comparison": {
      "type": "grouped_bar",
      "title": "Temperature Coefficients Comparison",
      "x_axis": "Parameter",
      "y_axis": "Temperature Coefficient (%/°C)",
      "series": ["Measured", "Datasheet", "Industry Typical"],
      "parameters": ["α (Isc)", "β (Voc)", "γ (Pmax)"]
    },
    "iv_curves_temperature_sweep": {
      "type": "multi_line",
      "title": "I-V Curves at Different Temperatures",
      "x_axis": "Voltage (V)",
      "y_axis": "Current (A)",
      "series": ["15°C", "25°C", "35°C", "45°C", "55°C", "65°C", "75°C"],
      "normalized_to_irradiance": true
    },
    "temperature_uniformity": {
      "type": "heatmap",
      "title": "Module Temperature Distribution",
      "description": "Temperature uniformity across module surface",
      "time_series": true
    }
  },
  "qc_checks": {
    "automatic": [
      {
        "check_id": "QC-013-001",
        "parameter": "alpha_isc_r_squared",
        "condition": "greater_than",
        "threshold": 0.98,
        "severity": "critical",
        "message": "Poor fit quality for Isc coefficient"
      },
      {
        "check_id": "QC-013-002",
        "parameter": "beta_voc_r_squared",
        "condition": "greater_than",
        "threshold": 0.98,
        "severity": "critical",
        "message": "Poor fit quality for Voc coefficient"
      },
      {
        "check_id": "QC-013-003",
        "parameter": "gamma_pmax_r_squared",
        "condition": "greater_than",
        "threshold": 0.98,
        "severity": "critical",
        "message": "Poor fit quality for Pmax coefficient"
      },
      {
        "check_id": "QC-013-004",
        "parameter": "temperature_uniformity",
        "condition": "max_difference_less_than",
        "threshold": 2.0,
        "unit": "°C",
        "severity": "warning",
        "message": "Poor temperature uniformity across module"
      },
      {
        "check_id": "QC-013-005",
        "parameter": "irradiance_stability",
        "condition": "coefficient_of_variation_less_than",
        "threshold": 5,
        "unit": "%",
        "severity": "warning",
        "message": "Irradiance not stable during test"
      },
      {
        "check_id": "QC-013-006",
        "parameter": "gamma_pmax",
        "condition": "within_range",
        "range": [-0.7, -0.2],
        "unit": "%/°C",
        "severity": "warning",
        "message": "Temperature coefficient outside typical range for technology"
      }
    ],
    "manual": [
      {
        "check_id": "QC-013-M01",
        "description": "Verify temperature sensors properly attached to module",
        "type": "boolean",
        "required": true
      },
      {
        "check_id": "QC-013-M02",
        "description": "Confirm stabilization achieved at each temperature",
        "type": "boolean",
        "required": true
      },
      {
        "check_id": "QC-013-M03",
        "description": "Check for condensation at low temperatures",
        "type": "boolean",
        "required": true
      },
      {
        "check_id": "QC-013-M04",
        "description": "Verify no shading or reflections during measurement",
        "type": "boolean",
        "required": true
      }
    ]
  },
  "maintenance": {
    "equipment": [
      {
        "equipment_id": "climate_chamber",
        "name": "Climate Chamber / Environmental Chamber",
        "calibration_required": true,
        "calibration_interval_days": 365,
        "verification_checks": [
          "temperature_uniformity",
          "temperature_stability",
          "temperature_accuracy"
        ]
      },
      {
        "equipment_id": "temperature_sensors",
        "name": "RTD/Thermocouple Array",
        "calibration_required": true,
        "calibration_interval_days": 365,
        "quantity": 4
      },
      {
        "equipment_id": "solar_simulator",
        "name": "Solar Simulator (Constant Irradiance)",
        "calibration_required": true,
        "calibration_interval_days": 365,
        "stability_critical": true
      },
      {
        "equipment_id": "iv_tracer",
        "name": "I-V Curve Tracer",
        "calibration_required": true,
        "calibration_interval_days": 365
      }
    ],
    "preventive_maintenance": [
      {
        "task": "Verify climate chamber temperature uniformity",
        "frequency_days": 90,
        "estimated_time_minutes": 60
      },
      {
        "task": "Calibrate temperature sensor array",
        "frequency_days": 180,
        "estimated_time_minutes": 120
      },
      {
        "task": "Check light source stability over temperature range",
        "frequency_days": 90,
        "estimated_time_minutes": 45
      }
    ]
  },
  "project_management": {
    "estimated_duration_minutes": 240,
    "required_personnel": 1,
    "required_skills": [
      "pv_testing",
      "temperature_controlled_testing",
      "statistical_analysis"
    ],
    "safety_requirements": [
      "Electrical safety training",
      "PPE: Safety glasses, insulated gloves",
      "Heat safety awareness (high temperature testing)"
    ],
    "dependencies": {
      "required_protocols": [],
      "optional_protocols": ["PVTP-010", "PVTP-011"],
      "blocking_conditions": [
        "Climate chamber not functioning",
        "Temperature sensors calibration expired",
        "Light source not stable"
      ]
    },
    "deliverables": [
      {
        "type": "test_report",
        "format": "PDF",
        "template": "PVTP-013_report_template.html",
        "includes": [
          "temperature_coefficients",
          "regression_plots",
          "comparison_to_datasheet",
          "uncertainty_analysis"
        ]
      },
      {
        "type": "data_export",
        "format": "Excel",
        "includes": [
          "all_temperature_points",
          "normalized_data",
          "regression_results",
          "uncertainty_budget"
        ]
      },
      {
        "type": "certificate",
        "format": "PDF",
        "condition": "qc_passed",
        "includes": ["temperature_coefficients_table"]
      }
    ],
    "dashboard_metrics": [
      "alpha_isc",
      "beta_voc",
      "gamma_pmax",
      "regression_quality",
      "coefficient_deviation_from_datasheet"
    ]
  },
  "nonconformance": {
    "triggers": [
      {
        "condition": "poor_regression_fit",
        "threshold_r_squared": 0.95,
        "severity": "critical",
        "nc_category": "measurement_quality"
      },
      {
        "condition": "coefficient_out_of_range",
        "severity": "major",
        "nc_category": "performance_anomaly"
      },
      {
        "condition": "large_deviation_from_datasheet",
        "threshold": 30,
        "unit": "%",
        "severity": "major",
        "nc_category": "specification_mismatch"
      },
      {
        "condition": "temperature_non_uniformity",
        "threshold": 3.0,
        "unit": "°C",
        "severity": "major",
        "nc_category": "test_conditions"
      },
      {
        "condition": "irradiance_instability",
        "severity": "major",
        "nc_category": "test_conditions"
      }
    ],
    "workflow": {
      "auto_create_nc": true,
      "require_investigation": true,
      "require_root_cause": true,
      "require_corrective_action": true,
      "notification_roles": ["lab_manager", "quality_manager", "engineering"]
    },
    "documentation_required": [
      "regression_plots",
      "comparison_to_specification",
      "environmental_conditions",
      "root_cause_analysis",
      "corrective_actions"
    ]
  }
}
